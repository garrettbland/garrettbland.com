<html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta httpequiv="Content-Type" content="text/html; charset=utf-8"><meta name="language" content="English"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Moving my site to Next.js</title><meta name="description" content=""><meta property="og:title" content="Moving my site to Next.js"><meta property="og:site_name" content="Moving my site to Next.js"><meta property="og:url" content=""><meta property="og:description" content=""><meta property="og:type" content="website"><link rel="shortcut icon" type="image/ico" href="/favicon.ico"><link rel="stylesheet" href="/style.css?v=1635015516843"></head><body x-data="darkMode" class="transition-all" x-bind:class="isDarkModeEnabled ? 'dark bg-blueGray-900' : 'bg-gray-50'"><main class="mb-24"><nav class="max-w-xl mx-auto px-4"><div class="flex justify-between items-center py-4"><a class="font-lexa relative z-20 text-xl dark:text-white font-semibold hover:underline" href="/">Garrett Bland</a><div class="flex items-center flex-row space-x-2"><button class="transform ease-in-out duration-150 hover:scale-110 origin-center p-1 hover:bg-gray-100 dark:hover:bg-blue-900 rounded-lg" x-on:click="toggleDarkMode()"><div class="relative w-8 h-8"><svg class="h-8 w-8 p-1 text-gray-700 hover:text-gray-700 dark:text-blue-50 absolute top-0 left-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-show="isDarkModeEnabled" x-transition.opacity="" xmlns="http://www.w3.org/2000/svg"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path></svg> <svg class="h-8 w-8 p-1 text-gray-700 absolute top-0 left-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" x-show="!isDarkModeEnabled" x-transition.opacity="" xmlns="http://www.w3.org/2000/svg"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path></svg></div></button> <a class="transform ease-in-out duration-150 hover:scale-110 origin-center p-1 hover:bg-gray-100 dark:hover:bg-blue-900 rounded-lg" href="https://github.com/garrettbland" rel="noreferrer" target="_blank"><img alt="github-logo" class="w-8 h-8" src="/images/github.png" loading="lazy"> </a><a class="transform ease-in-out duration-150 hover:scale-110 origin-center p-1 hover:bg-gray-100 dark:hover:bg-blue-900 rounded-lg" href="https://twitter.com/gbland777" rel="noreferrer" target="_blank"><img alt="twitter-logo" class="w-8 h-8" src="/images/twitter.png" loading="lazy"></a></div></div><div class="h-px w-full bg-gradient-to-r from-transparent via-gray-200 to-transparent mb-6 dark:via-indigo-700"></div></nav><section><div><article class="prose prose-lg dark:prose-dark"><h1 class="leading-loose">Moving my site to Next.js</h1><p class="flex flex-row items-center"><span class="mr-2"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg> </span>Posted on <time class="ml-1" datetime="2021-01-11 18:00">Jan 11, 2021</time></p><p>Edit: This isn't the case anymore - I went back to 11ty</p><p>Currently, my site is powered by <a href="https://www.11ty.dev/">Eleventy</a>, which is a very very cool static site generator. I actually made an eleventy github template (<a href="https://eleventykit.netlify.app/">Eleventy Kit</a>) that I use frequently for work projects.</p><p>However, I've been finding myself using <a href="https://nextjs.org/">Next.js</a> more and more for projects, and <a href="https://www.netlify.com/">Netlify's</a> integration is just stupid easy. I also love <a href="https://reactjs.org/">React</a>, and using react components is much more native feeling than using a templating engine like <a href="https://shopify.github.io/liquid/">Liquid</a>. I also love the ability to natively run Next SSR with serverless for any server side processing or SEO benefits. So, I decided its time to migrate over. I'm going to walk through my process of moving over my kinda-janky-website-setup to Next.</p><h3>Clean up time</h3><p>Originally I had built my site with Eleventy and a custom webpack config so I could setup playdates with other packages like <a href="https://vuejs.org/">Vue</a> and <a href="https://svelte.dev/">Svelte</a>. I had planned on running a lot of experiments and such with multiple frameworks, but I'm going to remove them now. Any time I want to write about another framework, I'll use <a href="https://codesandbox.io/">Code Sandbox</a>. I really want to focus more on writing about my development adventures and code examples. I'm also going to remove google analytics and move to another solution.</p><h3>New branch time</h3><p>Anytime I go through a large overhaul (in my mind) I like to create a new branch. Just incase I mess things up <em>horribly</em>, I can always nuke it and start over. I'm elegantly calling my new branch <code>nextjs</code>. Now I'll throw everything in the current directory (except for the git stuff &amp; package.json), into a new directory named <code>_old</code>.</p><h3>Setting up Next</h3><p>Now I have a fresh empty repo, I'm going to uninstall all packages from my <code>package.json</code>. Definitely not needed, but it just works cleaner in my mind that way. I also know that I will have different scripts I will be runnings with Next, so I'll remove all of those as well.</p><p><em>Next</em> up is actually installing Next (ðŸ˜ƒ get it). I'll just follow their setup instructions to manually install. I'll also follow their instructions to setup the proper script and to create a <code>tsconfig.json</code> file, so I can use <a href="https://www.typescriptlang.org/">Typescript</a>.</p><h3>Installing dependencies</h3><p>Since I'll be using Typescript, I'll need to install a few different <code>type</code> packages as well as Typescript itself. I'll also be using the amazing TailwindCSS, along with their new JIT compiler. A few other tools will be thrown in like Prettier &amp; PostCSS as well.</p><pre><code class="language-bash">npm install tailwindcss @tailwindcss/jit typescript @types/node @types/react autoprefixer postcss prettier -D
</code></pre><p>Along with these, I'll also setup a few configs for postcss, prettier, nextjs, netlify, etc for preferences along with the initial page and the tailwind imports. Finally I'll run <code>npm run dev</code> to make sure everything is setup correctly and I can load up my new bare site.</p><h3>Making it look pretty</h3><p>Since I'm mostly happy with how my site looks for now, I'll keep all of the same styling and setup components for the layout, pages, header, etc. Its all tailwind, so its mainly just a bunch of making sure its proper JSX, making sure to test the dev site along the way to make sure its all going good.</p><h3>Now for the markdown</h3><p>I enjoy writing my posts in markdown, just to keep it looking minimal and nice. Currently my few posts are written in markdown, so I need to setup a way to parse the markdown and use it within my next app.</p><p>I just ended up following <a href="https://www.netlify.com/blog/2020/05/04/building-a-markdown-blog-with-next-9.4-and-netlify/">this blog post</a> from Netlify to setup parsing the markdown. I also moved all posts into a single directory, and will start giving my projects and posts different types. That way its a little neater to store everything in one place for my writing.</p><h3>Fixing code examples</h3><p>My code examples using PrismJS are giving me issues. Somewhere in the markdown to converting to code isn't the same as it was with Eleventy. I had a decent amount of trouble the first time wit Prism, so this might be challenging.</p><p>After reading through the docs, all I need to do is apply the highlighting after the <code>DOM</code> has mounted. So I setup the Prism highlight function in a <code>useEffect</code> hook. I also brought in Fira Code from google analytics, because that's also what I use in my local IDE.</p><pre><code class="language-js">useEffect(() =&gt; {
    prism.highlightAll()
}, [])
</code></pre><h3>Wrapping up</h3><p>Now the last little bit is just me going through and updating little things here and there. I've noticed a lot of things I plan on upgrading and fixing, but for now I have the site transferred over to Next, and I'll merge the branch with <code>master</code> to make it official.</p><p>Did run into issues with some typing as I have <code>strict: true</code> in my <code>tsconfig.json</code>. I had to install the correct webpack typings.</p><pre><code class="language-bash">npm i @types/webpack-env -D
</code></pre><p>I also ran into some issues with node versions in netlify and not having the needed functionality in Node v14.x.x. I had to go into the netlify UI and add an environment variable for <code>NODE_VERSION</code> equal to <code>14</code></p></article></div></section></main><script>function darkMode () {
            return {
                isDarkModeEnabled: false,
                init: function () {
                    console.log('Alpine ready to roll...')

                    // Watch for dark mode changing and update local storage
                    this.$watch('isDarkModeEnabled', (newValue) => {
                        console.log(`Setting dark mode in local storage to ${newValue}...`)
                        localStorage.setItem('isDarkModeEnabled', newValue)
                    })

                    // Initially grab local storage and set if local storage key is present
                    if (localStorage.getItem('isDarkModeEnabled')) {
                        this.isDarkModeEnabled = JSON.parse(localStorage.getItem('isDarkModeEnabled'))
                    }
                },
                toggleDarkMode: function () {
                    this.isDarkModeEnabled = !this.isDarkModeEnabled
                }
            }
        }</script><script src="/alpine.js?v=1635015516843"></script><script src="/prism.min.js"></script></body></html>